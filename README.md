# Place Cell Simulation

## Introduction
This repository holds the code for the project described in my bachelor thesis titled "Klassifizierung von Bildern mithilfe von un√ºberwachtem Lernen mit Kohonen-Netzen". The goal was to simulate the behaviour of place cells found in the brain of several animals using machine learning. We generate visual data from the perspective of an agent in a simulated maze and use the resulting images for determining the currently activated place unit. This is done by removing the classifier network of a Convolutional Neural Network and using the vector generated by the feature extraction network as input for a Self-organizing Map. The BMU from said SOM then correlates to the activated place unit. For an extensive introduction into this project please refer to the enclosed thesis paper.

## Requirements

The system is split into a frontend running in Unity Version 2020.3 and a backend implemented using Python 3.9. The requirements.txt in the backend directory holds all the utilized python packages.


## Simulation
The simulation can be run by importing the frontend directory into Unity as a project. Open the SampleScene in order to access the maze. After starting the simulation the game view shows the perspective of the agent in the maze. It is possible to move using the W and S keys and turn by using the mouse. Press the N key in order to generate training or test data which will cause the controls to be disabled and start teleporting the agent to random positions in the maze while simultaneously taking images of the game view. The number of generated images can be adjusted in the ScreenshotGenerator Game Object.

In order to determine the currently activated place unit at runtime of the frontend and display the result in the neural network in the top left corner it is necessary to start the backend server before running the simulation. More on that in the next section. The C key toggles a different view displaying a top-down visualization of the place unit activity in the maze.

## Backend
The Backend folder holds all of the python code used for training and inferencing on the system. The cnn and som modules provide utility for creating and using the respective component. train.py and test.py can be used in order to train or test a new Self-organizing map, however, a fully trained and tested version is already present in the form of the som_trained.npy file. This SOM is also the one that will be used when inferencing on the simulation at runtime. As previously mentioned, for that to work you will need to first start the backend server by executing websocket.py so that front- and backend can communicate. The Experiments directory simply contains code that was used for experiments described in the thesis paper.
